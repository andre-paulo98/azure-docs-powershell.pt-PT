---
title: Migrar scripts do Azure PowerShell do AzureRM para o Az
description: Conheça os passos e as ferramentas para migrar scripts do módulo do AzureRM para o novo módulo do Az.
author: sptramer
ms.author: sttramer
manager: carmonm
ms.devlang: powershell
ms.topic: conceptual
ms.date: 12/13/2018
ms.openlocfilehash: 28122ca953d62b405f19effbbc680f2dc6202cca
ms.sourcegitcommit: 89066b7c4b527357bb2024e1ad708df84c131804
ms.translationtype: HT
ms.contentlocale: pt-PT
ms.lasthandoff: 04/09/2019
ms.locfileid: "59364278"
---
# <a name="migrate-from-azurerm-to-azure-powershell-az"></a><span data-ttu-id="ebdd1-103">Migrar do AzureRM para o Azure PowerShell Az</span><span class="sxs-lookup"><span data-stu-id="ebdd1-103">Migrate from AzureRM to Azure PowerShell Az</span></span>

<span data-ttu-id="ebdd1-104">O módulo do Az tem paridade de funcionalidades com o AzureRM, mas utiliza nomes de cmdlet mais curtos e mais consistentes.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-104">The Az module has feature parity with AzureRM, but uses shorter and more consistent cmdlet names.</span></span>
<span data-ttu-id="ebdd1-105">Os scripts escritos para os cmdlets do AzureRM não irão funcionar automaticamente com o módulo novo.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-105">Scripts written for the AzureRM cmdlets won't automatically work with the new module.</span></span> <span data-ttu-id="ebdd1-106">Para facilitar a transição, o Az oferece ferramentas para permitir a execução dos seus scripts existentes com o AzureRM.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-106">To make the transition easier, Az offers tools to allow you to run your existing scripts using AzureRM.</span></span> <span data-ttu-id="ebdd1-107">Uma migração para um novo conjunto de comandos nunca é conveniente, mas este artigo ajuda-o a fazer a transição para o novo módulo.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-107">No migration to a new command set is ever convenient, but this article will help you get started on transitioning to the new module.</span></span>

<span data-ttu-id="ebdd1-108">Para ver a lista completa das alterações interruptivas entre o AzureRM e o Az, consulte o [Guia de migração do Az 1.0.0](migrate-az-1.0.0.md)</span><span class="sxs-lookup"><span data-stu-id="ebdd1-108">To see the full list of breaking changes between AzureRM and Az, see the [Migration guide for Az 1.0.0](migrate-az-1.0.0.md)</span></span>

## <a name="check-for-installed-versions-of-azurerm"></a><span data-ttu-id="ebdd1-109">Verificar se existem versões instaladas do AzureRM</span><span class="sxs-lookup"><span data-stu-id="ebdd1-109">Check for installed versions of AzureRM</span></span>

<span data-ttu-id="ebdd1-110">O módulo do Az pode estar instalado lado a lado com o módulo do AzureRM, mas tal não é recomendável.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-110">The Az module can be installed side-by-side with the AzureRM module, but this is not recommended.</span></span> <span data-ttu-id="ebdd1-111">Antes de realizar quaisquer passos de migração, verifique quais são as versões do AzureRM que se encontram instaladas no sistema.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-111">Before taking any migration steps, check which versions of AzureRM are installed on your system.</span></span> <span data-ttu-id="ebdd1-112">Ao fazê-lo, certifica-se de que os scripts já estão em execução na versão mais recente e fica a saber se pode ativar aliases de comandos sem desinstalar o AzureRM.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-112">Doing so allows you to make sure scripts are already running on the latest release, and let you know if you can enable command aliases without uninstalling AzureRM.</span></span>

<span data-ttu-id="ebdd1-113">Para verificar quais são as versões do AzureRM que se encontram instaladas, execute o comando:</span><span class="sxs-lookup"><span data-stu-id="ebdd1-113">To check which version(s) of AzureRM you have installed, run the command:</span></span>

```powershell-interactive
Get-InstalledModule -Name AzureRM -AllVersions
```

## <a name="ensure-your-existing-scripts-work-with-the-latest-azurerm-release"></a><span data-ttu-id="ebdd1-114">Certifique-se de que os seus scripts existentes funcionam com a versão mais recente do AzureRM</span><span class="sxs-lookup"><span data-stu-id="ebdd1-114">Ensure your existing scripts work with the latest AzureRM release</span></span>

<span data-ttu-id="ebdd1-115">Este é o passo mais importante!</span><span class="sxs-lookup"><span data-stu-id="ebdd1-115">This is the most important step!</span></span> <span data-ttu-id="ebdd1-116">Execute os scripts existentes e certifique-se de que funcionam com a versão _mais recente_ do AzureRM (__6.13.1__).</span><span class="sxs-lookup"><span data-stu-id="ebdd1-116">Run your existing scripts, and make sure that they work with the _latest_ release of AzureRM (__6.13.1__).</span></span> <span data-ttu-id="ebdd1-117">Se os scripts não funcionarem, certifique-se de que lê o [guia de migração do AzureRM](/powershell/azure/azurerm/migration-guide.6.0.0).</span><span class="sxs-lookup"><span data-stu-id="ebdd1-117">If your scripts don't work, make sure to read the [AzureRM migration guide](/powershell/azure/azurerm/migration-guide.6.0.0).</span></span>

## <a name="install-the-azure-powershell-az-module"></a><span data-ttu-id="ebdd1-118">Instalar o módulo do Azure PowerShell Az</span><span class="sxs-lookup"><span data-stu-id="ebdd1-118">Install the Azure PowerShell Az module</span></span>

<span data-ttu-id="ebdd1-119">O primeiro passo é instalar o módulo do Az na sua plataforma.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-119">The first step is to install the Az module on your platform.</span></span> <span data-ttu-id="ebdd1-120">Quando instalar o Az, recomenda-se que desinstale o AzureRM.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-120">When you install Az, it's recommended that you uninstall AzureRM.</span></span> <span data-ttu-id="ebdd1-121">Nos passos seguintes, irá aprender como continuar a executar os scripts existentes e permitir a compatibilidade dos nomes de cmdlet antigos.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-121">In the following steps, you'll learn how to keep running your existing scripts and enable compatibility for old cmdlet names.</span></span>

<span data-ttu-id="ebdd1-122">Para instalar o módulo do Azure PowerShell Az, siga estes passos:</span><span class="sxs-lookup"><span data-stu-id="ebdd1-122">To install the Azure PowerShell Az module, follow these steps:</span></span>

* <span data-ttu-id="ebdd1-123">__RECOMENDADO__: [Desinstalar o módulo do AzureRM](/powershell/azure/uninstall-az-ps#uninstall-the-azurerm-module).</span><span class="sxs-lookup"><span data-stu-id="ebdd1-123">__RECOMMENDED__: [Uninstall the AzureRM module](/powershell/azure/uninstall-az-ps#uninstall-the-azurerm-module).</span></span>
  <span data-ttu-id="ebdd1-124">Certifique-se de que remove _todas_ as versões instaladas do AzureRM, e não apenas a versão mais recente.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-124">Make sure that you remove _all_ installed versions of AzureRM, not just the most recent version.</span></span>
* [<span data-ttu-id="ebdd1-125">Instalar o módulo Az</span><span class="sxs-lookup"><span data-stu-id="ebdd1-125">Install the Az module</span></span>](install-az-ps.md)

## <a name="a-namealiasesenable-azurerm-compatibility-aliases"></a><span data-ttu-id="ebdd1-126"><a name="aliases"/>Ativar os aliases de compatibilidade do AzureRM</span><span class="sxs-lookup"><span data-stu-id="ebdd1-126"><a name="aliases"/>Enable AzureRM compatibility aliases</span></span> 

> [!IMPORTANT]
>
> <span data-ttu-id="ebdd1-127">Ative o modo de compatibilidade apenas se tiver desinstalado _todas as_ versões do AzureRM.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-127">Only enable compatibility mode if you've uninstalled _all_ versions of AzureRM.</span></span> <span data-ttu-id="ebdd1-128">A ativação do modo de compatibilidade com os cmdlets do AzureRM ainda disponíveis pode resultar num comportamento imprevisível.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-128">Enabling compatibility mode with AzureRM cmdlets still available may result in unpredictable behavior.</span></span> <span data-ttu-id="ebdd1-129">Ignore este passo se optar por manter o AzureRM instalado, mas tenha em atenção que os cmdlets do AzureRM irão utilizar os módulos mais antigos e não vão chamar quaisquer cmdlets do Az.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-129">Skip this step if you decided to keep AzureRM installed, but be aware that any AzureRM cmdlets will use the older modules and not call any Az cmdlets.</span></span>

<span data-ttu-id="ebdd1-130">Com o AzureRM desinstalado e os scripts a funcionarem com a versão mais recente do AzureRM, chegou o momento de ativar o modo de compatibilidade para o módulo do Az.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-130">With AzureRM uninstalled and your scripts working with the latest AzureRM version, the next step is to enable the compatibility mode for the Az module.</span></span> <span data-ttu-id="ebdd1-131">A compatibilidade é ativada com o comando:</span><span class="sxs-lookup"><span data-stu-id="ebdd1-131">Compatibility is enabled with the command:</span></span>

```powershell-interactive
Enable-AzureRmAlias -Scope CurrentUser
```

<span data-ttu-id="ebdd1-132">Os aliases ativam a capacidade de utilizar nomes de cmdlets antigos com o módulo do Az instalado.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-132">Aliases enable the ability to use old cmdlet names with the Az module installed.</span></span> <span data-ttu-id="ebdd1-133">Estes aliases são escritos para o perfil de utilizador do âmbito selecionado.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-133">These aliases are written to the user profile for the selected scope.</span></span> <span data-ttu-id="ebdd1-134">Se não existir um perfil de utilizador, é criado um.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-134">If no user profile exists, one is created.</span></span>

> [!WARNING]
>
> <span data-ttu-id="ebdd1-135">Pode utilizar um `-Scope` diferente para este comando, mas tal não é recomendado.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-135">You can use a different `-Scope` for this command, but it's not recommended.</span></span> <span data-ttu-id="ebdd1-136">Os aliases são escritos para o perfil de utilizador para o âmbito selecionado, por isso continue a permitir que tenham um âmbito o mais limitado possível.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-136">Aliases are written to the user profile for the selected scope, so keep enabling them to as limited a scope as possible.</span></span> <span data-ttu-id="ebdd1-137">A ativação dos aliases no sistema em geral também pode causar problemas a outros utilizadores que tenham o AzureRM instalado no respetivo âmbito local.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-137">Enabling aliases system-wide could also cause issues for other users which have AzureRM installed in their local scope.</span></span>

<span data-ttu-id="ebdd1-138">Assim que o modo de alias estiver ativado, execute os seus scripts novamente para confirmar que ainda funcionam como esperado.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-138">Once the alias mode is enabled, run your scripts again to confirm that they still function as expected.</span></span> 

## <a name="change-module-imports-and-cmdlet-names"></a><span data-ttu-id="ebdd1-139">Alterar importações de módulo e nomes de cmdlet</span><span class="sxs-lookup"><span data-stu-id="ebdd1-139">Change module imports and cmdlet names</span></span>

<span data-ttu-id="ebdd1-140">Em geral, os nomes dos módulos foram alterados para que `AzureRM` e `Azure` se tornassem `Az`, e o mesmo para os cmdlets.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-140">In general, the module names have been changed so that `AzureRM` and `Azure` become `Az`, and the same for cmdlets.</span></span>
<span data-ttu-id="ebdd1-141">Por exemplo, o módulo `AzureRM.Compute` foi renomeado para `Az.Compute`.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-141">For example, the `AzureRM.Compute` module has been renamed to `Az.Compute`.</span></span> `New-AzureRMVM` <span data-ttu-id="ebdd1-142">tornou-se `New-AzVM` e `Get-AzureStorageBlob` é agora `Get-AzStorageBlob`.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-142">has become `New-AzVM`, and `Get-AzureStorageBlob` is now `Get-AzStorageBlob`.</span></span>

<span data-ttu-id="ebdd1-143">Existem exceções a esta alteração de nomenclatura de que deve estar ciente.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-143">There are exceptions to this naming change that you should be aware of.</span></span> <span data-ttu-id="ebdd1-144">Os nomes de alguns módulos foram mudados ou intercalados com os de módulos existentes sem afetar o sufixo dos respetivos cmdlets, exceto o facto de alterar `AzureRM` ou `Azure` para `Az`.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-144">Some modules were renamed or merged into existing modules without this affecting the suffix of their cmdlets, other than changing `AzureRM` or `Azure` to `Az`.</span></span> <span data-ttu-id="ebdd1-145">Fora isso, o sufixo do cmdlet completo foi alterado de modo a refletir o novo nome do módulo.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-145">Otherwise, the full cmdlet suffix was changed to reflect the new module name.</span></span>

| <span data-ttu-id="ebdd1-146">Módulo do AzureRM</span><span class="sxs-lookup"><span data-stu-id="ebdd1-146">AzureRM module</span></span> | <span data-ttu-id="ebdd1-147">Módulo do Az</span><span class="sxs-lookup"><span data-stu-id="ebdd1-147">Az module</span></span> | <span data-ttu-id="ebdd1-148">O sufixo do cmdlet foi alterado?</span><span class="sxs-lookup"><span data-stu-id="ebdd1-148">Cmdlet suffix changed?</span></span> |
|----------------|-----------|------------------------|
| <span data-ttu-id="ebdd1-149">AzureRM.Profile</span><span class="sxs-lookup"><span data-stu-id="ebdd1-149">AzureRM.Profile</span></span> | <span data-ttu-id="ebdd1-150">Az.Accounts</span><span class="sxs-lookup"><span data-stu-id="ebdd1-150">Az.Accounts</span></span> | <span data-ttu-id="ebdd1-151">Sim</span><span class="sxs-lookup"><span data-stu-id="ebdd1-151">Yes</span></span> |
| <span data-ttu-id="ebdd1-152">AzureRM.Insights</span><span class="sxs-lookup"><span data-stu-id="ebdd1-152">AzureRM.Insights</span></span> | <span data-ttu-id="ebdd1-153">Az.Monitor</span><span class="sxs-lookup"><span data-stu-id="ebdd1-153">Az.Monitor</span></span> | <span data-ttu-id="ebdd1-154">Sim</span><span class="sxs-lookup"><span data-stu-id="ebdd1-154">Yes</span></span> |
| <span data-ttu-id="ebdd1-155">AzureRM.DataFactories</span><span class="sxs-lookup"><span data-stu-id="ebdd1-155">AzureRM.DataFactories</span></span> | <span data-ttu-id="ebdd1-156">Az.DataFactory</span><span class="sxs-lookup"><span data-stu-id="ebdd1-156">Az.DataFactory</span></span> | <span data-ttu-id="ebdd1-157">Sim</span><span class="sxs-lookup"><span data-stu-id="ebdd1-157">Yes</span></span> |
| <span data-ttu-id="ebdd1-158">AzureRM.DataFactoryV2</span><span class="sxs-lookup"><span data-stu-id="ebdd1-158">AzureRM.DataFactoryV2</span></span> | <span data-ttu-id="ebdd1-159">Az.DataFactory</span><span class="sxs-lookup"><span data-stu-id="ebdd1-159">Az.DataFactory</span></span> | <span data-ttu-id="ebdd1-160">Sim</span><span class="sxs-lookup"><span data-stu-id="ebdd1-160">Yes</span></span> |
| <span data-ttu-id="ebdd1-161">AzureRM.RecoveryServices.Backup</span><span class="sxs-lookup"><span data-stu-id="ebdd1-161">AzureRM.RecoveryServices.Backup</span></span> | <span data-ttu-id="ebdd1-162">Az.RecoveryServices</span><span class="sxs-lookup"><span data-stu-id="ebdd1-162">Az.RecoveryServices</span></span> | <span data-ttu-id="ebdd1-163">Não</span><span class="sxs-lookup"><span data-stu-id="ebdd1-163">No</span></span> |
| <span data-ttu-id="ebdd1-164">AzureRM.RecoveryServices.SiteRecovery</span><span class="sxs-lookup"><span data-stu-id="ebdd1-164">AzureRM.RecoveryServices.SiteRecovery</span></span> | <span data-ttu-id="ebdd1-165">Az.RecoveryServices</span><span class="sxs-lookup"><span data-stu-id="ebdd1-165">Az.RecoveryServices</span></span> | <span data-ttu-id="ebdd1-166">Não</span><span class="sxs-lookup"><span data-stu-id="ebdd1-166">No</span></span> |
| <span data-ttu-id="ebdd1-167">AzureRM.Tags</span><span class="sxs-lookup"><span data-stu-id="ebdd1-167">AzureRM.Tags</span></span> | <span data-ttu-id="ebdd1-168">Az.Resources</span><span class="sxs-lookup"><span data-stu-id="ebdd1-168">Az.Resources</span></span> | <span data-ttu-id="ebdd1-169">Não</span><span class="sxs-lookup"><span data-stu-id="ebdd1-169">No</span></span> |
| <span data-ttu-id="ebdd1-170">AzureRM.MachineLearningCompute</span><span class="sxs-lookup"><span data-stu-id="ebdd1-170">AzureRM.MachineLearningCompute</span></span> | <span data-ttu-id="ebdd1-171">Az.MachineLearning</span><span class="sxs-lookup"><span data-stu-id="ebdd1-171">Az.MachineLearning</span></span> | <span data-ttu-id="ebdd1-172">Não</span><span class="sxs-lookup"><span data-stu-id="ebdd1-172">No</span></span> |
| <span data-ttu-id="ebdd1-173">AzureRM.UsageAggregates</span><span class="sxs-lookup"><span data-stu-id="ebdd1-173">AzureRM.UsageAggregates</span></span> | <span data-ttu-id="ebdd1-174">Az.Billing</span><span class="sxs-lookup"><span data-stu-id="ebdd1-174">Az.Billing</span></span> | <span data-ttu-id="ebdd1-175">Não</span><span class="sxs-lookup"><span data-stu-id="ebdd1-175">No</span></span> |
| <span data-ttu-id="ebdd1-176">AzureRM.Consumption</span><span class="sxs-lookup"><span data-stu-id="ebdd1-176">AzureRM.Consumption</span></span> | <span data-ttu-id="ebdd1-177">Az.Billing</span><span class="sxs-lookup"><span data-stu-id="ebdd1-177">Az.Billing</span></span> | <span data-ttu-id="ebdd1-178">Não</span><span class="sxs-lookup"><span data-stu-id="ebdd1-178">No</span></span> |

## <a name="summary"></a><span data-ttu-id="ebdd1-179">Resumo</span><span class="sxs-lookup"><span data-stu-id="ebdd1-179">Summary</span></span>

<span data-ttu-id="ebdd1-180">Ao seguir estes passos, pode atualizar todos os scripts existentes para utilizarem o módulo novo.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-180">By following these steps, you can update all of your existing scripts to use the new module.</span></span> <span data-ttu-id="ebdd1-181">Se tiver dúvidas ou problemas com estes passos que dificultaram a sua migração, comente este artigo para que possamos melhorar as instruções.</span><span class="sxs-lookup"><span data-stu-id="ebdd1-181">If you have any questions or problems with these steps that made your migration difficult, please comment on this article so that we can improve the instructions.</span></span>
